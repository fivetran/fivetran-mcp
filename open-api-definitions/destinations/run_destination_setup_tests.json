{
  "openapi": "3.0.1",
  "info": {
    "title": "Run Destination Setup Tests",
    "description": "Runs the setup tests for an existing destination within your Fivetran account."
  },
  "path": "/v1/destinations/{destinationId}/test",
  "method": "POST",
  "operation": {
    "tags": [
      "Destination Management"
    ],
    "summary": "Run Destination Setup Tests",
    "description": "Runs the setup tests for an existing destination within your Fivetran account.",
    "operationId": "run_destination_setup_tests",
    "parameters": [
      {
        "name": "destinationId",
        "in": "path",
        "description": "The unique identifier for the destination within the Fivetran system.",
        "required": true,
        "schema": {
          "type": "string",
          "example": "destinationId"
        },
        "example": "destinationId"
      },
      {
        "name": "Accept",
        "in": "header",
        "schema": {
          "type": "string",
          "example": "application/json;version=2",
          "default": "application/json;version=2"
        }
      }
    ],
    "requestBody": {
      "content": {
        "application/json": {
          "schema": {
            "$ref": "#/components/schemas/RunSetupTestsRequest_run_destination_setup_tests"
          },
          "examples": {
            "run_setup_tests_request": {
              "value": {
                "trust_certificates": true,
                "trust_fingerprints": true
              }
            }
          }
        }
      }
    },
    "responses": {
      "200": {
        "description": "Successful response",
        "content": {
          "application/json": {
            "schema": {
              "required": [
                "code",
                "data"
              ],
              "properties": {
                "code": {
                  "type": "string",
                  "description": "Response status code",
                  "example": "Success"
                },
                "message": {
                  "type": "string",
                  "description": "Response status text",
                  "example": "Operation performed."
                },
                "data": {
                  "$ref": "#/components/schemas/DestinationExtendedResponse"
                }
              }
            },
            "examples": {
              "run_setup_tests_response": {
                "value": {
                  "code": "Success",
                  "message": "Setup tests have been completed",
                  "data": {
                    "id": "destination_id",
                    "group_id": "group_id",
                    "service": "postgres_rds_warehouse",
                    "region": "GCP_US_EAST4",
                    "time_zone_offset": "-8",
                    "setup_status": "incomplete",
                    "setup_tests": [
                      {
                        "title": "Connecting to SSH tunnel",
                        "status": "FAILED",
                        "message": "Auth fail"
                      }
                    ],
                    "config": {
                      "public_key": "ssh-rsa ... fivetran user key",
                      "database": "database_name",
                      "password": "******",
                      "tunnel_port": "22",
                      "port": "5432",
                      "host": "test.host.com",
                      "tunnel_host": "test.tunnel.host.com",
                      "user": "user_name",
                      "connection_method": "SshTunnel",
                      "tunnel_user": "tunnel_user_name"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "404": {
        "description": "Not found error"
      }
    }
  },
  "components": {
    "schemas": {
      "RunSetupTestsRequest_run_destination_setup_tests": {
        "type": "object",
        "properties": {
          "trust_certificates": {
            "type": "boolean"
          },
          "trust_fingerprints": {
            "type": "boolean"
          }
        }
      },
      "DestinationExtendedResponse": {
        "required": [
          "group_id",
          "id",
          "region",
          "service",
          "setup_status",
          "time_zone_offset"
        ],
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "The unique identifier for the destination within the Fivetran system",
            "example": "destination_id"
          },
          "service": {
            "type": "string",
            "description": "The name for the destination type within the Fivetran system.",
            "example": "snowflake"
          },
          "region": {
            "type": "string",
            "description": "Data processing location. This is where Fivetran will operate and run computation on data.",
            "example": "GCP_US_EAST4",
            "enum": [
              "GCP_US_EAST4",
              "GCP_US_WEST1",
              "GCP_US_CENTRAL1",
              "GCP_EUROPE_WEST3",
              "GCP_AUSTRALIA_SOUTHEAST1",
              "GCP_NORTHAMERICA_NORTHEAST1",
              "GCP_EUROPE_WEST2",
              "GCP_ASIA_SOUTHEAST1",
              "GCP_ASIA_SOUTHEAST2",
              "GCP_ASIA_SOUTH1",
              "GCP_ASIA_NORTHEAST1",
              "AWS_US_EAST_1",
              "AWS_US_EAST_2",
              "AWS_US_WEST_2",
              "AWS_AP_NORTHEAST_1",
              "AWS_AP_SOUTHEAST_1",
              "AWS_AP_SOUTHEAST_2",
              "AWS_EU_CENTRAL_1",
              "AWS_EU_WEST_1",
              "AWS_EU_WEST_2",
              "AWS_AP_SOUTH_1",
              "AWS_CA_CENTRAL_1",
              "AWS_US_GOV_WEST_1",
              "AZURE_EASTUS2",
              "AZURE_AUSTRALIAEAST",
              "AZURE_UKSOUTH",
              "AZURE_WESTEUROPE",
              "AZURE_CENTRALUS",
              "AZURE_CANADACENTRAL",
              "AZURE_UAENORTH",
              "AZURE_SOUTHEASTASIA",
              "AZURE_EASTUS",
              "AZURE_JAPANEAST",
              "AZURE_CENTRALINDIA"
            ]
          },
          "networking_method": {
            "type": "string",
            "enum": [
              "Directly",
              "PrivateLink",
              "SshTunnel",
              "ProxyAgent"
            ]
          },
          "setup_status": {
            "type": "string",
            "description": "Destination setup status",
            "example": "CONNECTED",
            "enum": [
              "INCOMPLETE",
              "CONNECTED",
              "BROKEN"
            ]
          },
          "daylight_saving_time_enabled": {
            "type": "boolean",
            "description": "Shift my UTC offset with daylight savings time (US Only)",
            "example": true
          },
          "group_id": {
            "type": "string",
            "description": "The unique identifier for the group within the Fivetran system.",
            "example": "group_id"
          },
          "time_zone_offset": {
            "type": "string",
            "description": "Determines the time zone for the Fivetran sync schedule.",
            "example": "+3",
            "enum": [
              "-11",
              "-10",
              "-9",
              "-8",
              "-7",
              "-6",
              "-5",
              "-4",
              "-3",
              "-2",
              "-1",
              "0",
              "+1",
              "+2",
              "+3",
              "+4",
              "+5",
              "+6",
              "+7",
              "+8",
              "+9",
              "+10",
              "+11",
              "+12"
            ]
          },
          "setup_tests": {
            "type": "array",
            "description": "Setup tests results for this destination",
            "items": {
              "$ref": "#/components/schemas/SetupTestResultResponse"
            }
          },
          "local_processing_agent_id": {
            "type": "string",
            "description": "(Deprecated) The unique identifier for the hybrid deployment agent within the Fivetran system",
            "example": "local_processing_agent_id"
          },
          "private_link_id": {
            "type": "string",
            "description": "The unique identifier for the self-served private link that is used by the connection",
            "example": "private_link_id"
          },
          "proxy_agent_id": {
            "type": "string",
            "description": "The unique identifier for the proxy agent within the Fivetran system",
            "example": "proxy_agent_id"
          },
          "hybrid_deployment_agent_id": {
            "type": "string",
            "description": "The unique identifier for the hybrid deployment agent within the Fivetran system",
            "example": "hybrid_deployment_agent_id"
          }
        },
        "discriminator": {
          "propertyName": "service",
          "mapping": {
            "adls": "#/components/schemas/adls_DestinationExtendedResponse",
            "aiven_kafka_wh": "#/components/schemas/aiven_kafka_wh_DestinationExtendedResponse",
            "aurora_postgres_warehouse": "#/components/schemas/aurora_postgres_warehouse_DestinationExtendedResponse",
            "aurora_warehouse": "#/components/schemas/aurora_warehouse_DestinationExtendedResponse",
            "aws_msk_wh": "#/components/schemas/aws_msk_wh_DestinationExtendedResponse",
            "azure_postgres_warehouse": "#/components/schemas/azure_postgres_warehouse_DestinationExtendedResponse",
            "azure_sql_data_warehouse": "#/components/schemas/azure_sql_data_warehouse_DestinationExtendedResponse",
            "azure_sql_database": "#/components/schemas/azure_sql_database_DestinationExtendedResponse",
            "azure_sql_managed_db_warehouse": "#/components/schemas/azure_sql_managed_db_warehouse_DestinationExtendedResponse",
            "big_query": "#/components/schemas/big_query_DestinationExtendedResponse",
            "big_query_dts": "#/components/schemas/big_query_dts_DestinationExtendedResponse",
            "clickhouse": "#/components/schemas/clickhouse_DestinationExtendedResponse",
            "confluent_cloud_wh": "#/components/schemas/confluent_cloud_wh_DestinationExtendedResponse",
            "databricks": "#/components/schemas/databricks_DestinationExtendedResponse",
            "managed_big_query": "#/components/schemas/managed_big_query_DestinationExtendedResponse",
            "managed_data_lake": "#/components/schemas/managed_data_lake_DestinationExtendedResponse",
            "maria_rds_warehouse": "#/components/schemas/maria_rds_warehouse_DestinationExtendedResponse",
            "maria_warehouse": "#/components/schemas/maria_warehouse_DestinationExtendedResponse",
            "materialize": "#/components/schemas/materialize_DestinationExtendedResponse",
            "milvus": "#/components/schemas/milvus_DestinationExtendedResponse",
            "motherduck": "#/components/schemas/motherduck_DestinationExtendedResponse",
            "mysql_rds_warehouse": "#/components/schemas/mysql_rds_warehouse_DestinationExtendedResponse",
            "mysql_warehouse": "#/components/schemas/mysql_warehouse_DestinationExtendedResponse",
            "new_s3_datalake": "#/components/schemas/new_s3_datalake_DestinationExtendedResponse",
            "onelake": "#/components/schemas/onelake_DestinationExtendedResponse",
            "oracle_rac_warehouse": "#/components/schemas/oracle_rac_warehouse_DestinationExtendedResponse",
            "oracle_rds_warehouse": "#/components/schemas/oracle_rds_warehouse_DestinationExtendedResponse",
            "oracle_warehouse": "#/components/schemas/oracle_warehouse_DestinationExtendedResponse",
            "postgres_databricks_warehouse": "#/components/schemas/postgres_databricks_warehouse_DestinationExtendedResponse",
            "postgres_gcp_warehouse": "#/components/schemas/postgres_gcp_warehouse_DestinationExtendedResponse",
            "postgres_rds_warehouse": "#/components/schemas/postgres_rds_warehouse_DestinationExtendedResponse",
            "postgres_warehouse": "#/components/schemas/postgres_warehouse_DestinationExtendedResponse",
            "redshift": "#/components/schemas/redshift_DestinationExtendedResponse",
            "singlestore": "#/components/schemas/singlestore_DestinationExtendedResponse",
            "snowflake": "#/components/schemas/snowflake_DestinationExtendedResponse",
            "sql_server_rds_warehouse": "#/components/schemas/sql_server_rds_warehouse_DestinationExtendedResponse",
            "sql_server_warehouse": "#/components/schemas/sql_server_warehouse_DestinationExtendedResponse",
            "surrealdb_destination": "#/components/schemas/surrealdb_destination_DestinationExtendedResponse",
            "teradata_destination": "#/components/schemas/teradata_destination_DestinationExtendedResponse"
          }
        }
      },
      "SetupTestResultResponse": {
        "required": [
          "status",
          "title"
        ],
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "description": "Setup test title",
            "example": "Test Title"
          },
          "status": {
            "type": "string",
            "description": "Setup test status",
            "example": "FAILED",
            "enum": [
              "PASSED",
              "SKIPPED",
              "WARNING",
              "FAILED",
              "JOB_FAILED"
            ]
          },
          "message": {
            "type": "string",
            "description": "Setup test message",
            "example": "Test Message"
          },
          "details": {
            "type": "object",
            "description": "Setup test details",
            "example": "..."
          }
        }
      }
    }
  }
}